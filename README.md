Working on the version V2 now.
You can see the code at branch 'V2'.
